<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="index.css">
  <title>Работа с DOM</title>
</head>
<body>
<div id="tasks">
  <div class="tasks__wrapper">
    <form class="create-task-block">
      <input
        name="taskName"
        class="create-task-block__input default-text-input"
        type="text"
        placeholder="Создайте новую задачу"
        value="Посмотреть урок по JavaScript"
      >
      <button
        type="submit"
        class="create-task-block__button default-button"
      >
        Создать
      </button>
    </form>
    <div class="tasks-list"></div>
  </div>
</div>

<script>
  'use strict'
  const tasks = [
    {
      id: '1138465078061',
      completed: false,
      text: 'Посмотреть новый урок по JavaScript',
    },
    {
      id: '1138465078062',
      completed: false,
      text: 'Выполнить тест после урока',
    },
    {
      id: '1138465078063',
      completed: false,
      text: 'Выполнить ДЗ после урока',
    },
  ]
  const list = document.querySelector('.tasks-list')

  function createEl(typeEl, classEl, attr, text) {
    const htmlTag = document.createElement(typeEl)

    if (classEl) {
      if (!Array.isArray(classEl)) {
        htmlTag.classList.add(classEl)
      } else {
        htmlTag.classList.add(...classEl)
      }
    }
    if (attr) {
      htmlTag.setAttribute(attr.type, attr.value)
    }
    if (text) {
      htmlTag.textContent = text
    }
    return htmlTag
  }

  function createTask(id, textEl) {
    const item = createEl('div', 'task-item', {type: 'data-task-id', value: id}),
      container = createEl('div', 'task-item__main-container'),
      content = createEl('div', 'task-item__main-content'),
      form = createEl('form', 'checkbox-form'),
      input = createEl('input', 'checkbox-form__checkbox', {type: 'type', value: 'checkbox'}),
      label = createEl('label', '', {type: 'for', value: `task-${id}`}),
      span = createEl('span', 'task-item__text', '', textEl),
      button = createEl('button', ['task-item__delete-button', 'default-button', 'delete-button'], {
        type: 'data-delete-task-id',
        value: id
      }, 'Удалить')

    input.setAttribute('id', `task-${id}`)

    item.append(container)
    container.append(content, button)
    content.append(form, span)
    form.append(input, label)
    list.append(item)
  }

  tasks.forEach(instance => createTask(instance.id, instance.text))



  // Задание #1 / 14. Работа с DOM. Часть 2 / Модуль 1. База JavaScript
  const form = document.querySelector('.create-task-block')
  const formInput = form.querySelector('.create-task-block__input')

  form.addEventListener('submit', (event) => {
    event.preventDefault()

    const value = formInput.value
    const id = Date.now()
    const instance = {
      id: String(id),
      completed: false,
      text: value,
    }
    tasks.push(instance)

    createTask(id, value)
    console.log('Показываю массив tasks: ', tasks)
  })

</script>
</body>
</html>
